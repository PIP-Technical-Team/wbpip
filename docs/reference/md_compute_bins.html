<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute bins — md_compute_bins • wbpip</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute bins — md_compute_bins" />
<meta property="og:description" content="Compute bins for microdata." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wbpip</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic_functions.html">Basic functions</a>
    </li>
    <li>
      <a href="../articles/compute_median_using_S3.html">Compute median using S3 system</a>
    </li>
    <li>
      <a href="../articles/compute_pip_stats.html">compute_pip_stats</a>
    </li>
    <li>
      <a href="../articles/compute_SPL.html">compute_SPL</a>
    </li>
    <li>
      <a href="../articles/interpolation.html">How to interpolate between two surveys</a>
    </li>
    <li>
      <a href="../articles/microdata_workflow.html">microdata_workflow</a>
    </li>
    <li>
      <a href="../articles/review_gd_compute_pip_stats.html">review_select_lorenz</a>
    </li>
    <li>
      <a href="../articles/review_lb_code.html">review_lb_code</a>
    </li>
    <li>
      <a href="../articles/review_lq_code.html">review_lq_code</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PIP-Technical-Team/wbpip/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute bins</h1>
    <small class="dont-index">Source: <a href='https://github.com/PIP-Technical-Team/wbpip/blob/master/R/md_compute_bins.R'><code>R/md_compute_bins.R</code></a></small>
    <div class="hidden name"><code>md_compute_bins.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute bins for microdata.</p>
    </div>

    <pre class="usage"><span class='fu'>md_compute_bins</span><span class='op'>(</span><span class='va'>welfare</span>, <span class='va'>weight</span>, nbins <span class='op'>=</span> <span class='fl'>100</span>, na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>, output <span class='op'>=</span> <span class='st'>"simple"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>welfare</th>
      <td><p>numeric: A vector of income or consumption values.</p></td>
    </tr>
    <tr>
      <th>weight</th>
      <td><p>numeric: A vector of weights.</p></td>
    </tr>
    <tr>
      <th>nbins</th>
      <td><p>numeric: Number of bins.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical: If TRUE it will exclude all NA in calculations</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>character: It has two varieties. 1) it could be a vector of
variables to retain after calculations (variables available are "welfare",
"weight", "cum_pop", "cum_prop_pop", and "bins"). 2) It could be a one of
two key words, "simple" or "full". <code>output = "simple"</code> is equivalent to
<code>output = "bins"</code> (which is the default). <code>output = "full"</code> if equivalent
to a vector with all the variables available, <code>output = c("welfare", "weight", "cum_pop", "cum_prop_pop","bins")</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data.table</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Compute percentiles (bins) accumulating by population rather than by welfare.
It differs from the common way to calculate percentiles because the
categories are defined by the ideal size of the quantile rather than by the
cutpoints.</p>
<p>This is why the function is called <code>bins</code> rather than quantiles because it
actually divides the population in equal bins sorted by the welfare aggregate
rather than calculate proper percentiles.</p>
<p>This function however, yields less unequally sized categories when 1) the
cutpoint value is frequent, 2) when using weights high variance or 3) when
the number of observations in the dataset is not a product of the number of
quantiles. Keep in mind that it may not work properly on small datasets or if
calculated for small groups. If the number of observations in the dataset or
group is small, tabulate afterwards to check the results. you may use <code>tp &lt;- df[, sum(weight)]; df[, round((sum(weight)/(tp))*100, digits = 2) , by = bins]</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>wbpip</span><span class='fu'>:::</span><span class='fu'>md_compute_bins</span><span class='op'>(</span>welfare <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2000</span>, weight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2000</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       bins
#&gt;    1:    1
#&gt;    2:    1
#&gt;    3:    1
#&gt;    4:    1
#&gt;    5:    1
#&gt;   ---     
#&gt; 1996:  100
#&gt; 1997:  100
#&gt; 1998:  100
#&gt; 1999:  100
#&gt; 2000:  100</div><div class='input'><span class='fu'>wbpip</span><span class='fu'>:::</span><span class='fu'>md_compute_bins</span><span class='op'>(</span>welfare <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2000</span>, weight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2000</span><span class='op'>)</span>,
 output <span class='op'>=</span> <span class='st'>'full'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       welfare weight cum_pop cum_prop_pop bins
#&gt;    1:       1      1       1       0.0005    1
#&gt;    2:       2      1       2       0.0010    1
#&gt;    3:       3      1       3       0.0015    1
#&gt;    4:       4      1       4       0.0020    1
#&gt;    5:       5      1       5       0.0025    1
#&gt;   ---                                         
#&gt; 1996:    1996      1    1996       0.9980  100
#&gt; 1997:    1997      1    1997       0.9985  100
#&gt; 1998:    1998      1    1998       0.9990  100
#&gt; 1999:    1999      1    1999       0.9995  100
#&gt; 2000:    2000      1    2000       1.0000  100</div><div class='input'><span class='fu'>wbpip</span><span class='fu'>:::</span><span class='fu'>md_compute_bins</span><span class='op'>(</span>welfare <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2000</span>, weight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2000</span><span class='op'>)</span>,
  output <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'cum_pop'</span>, <span class='st'>'cum_prop_pop'</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       cum_pop cum_prop_pop
#&gt;    1:       1       0.0005
#&gt;    2:       2       0.0010
#&gt;    3:       3       0.0015
#&gt;    4:       4       0.0020
#&gt;    5:       5       0.0025
#&gt;   ---                     
#&gt; 1996:    1996       0.9980
#&gt; 1997:    1997       0.9985
#&gt; 1998:    1998       0.9990
#&gt; 1999:    1999       0.9995
#&gt; 2000:    2000       1.0000</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tony Fujs, Aleksander Eilertsen, R. Andrés Castañeda, Ifeanyi Nzegwu Edochie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


