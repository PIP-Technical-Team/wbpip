lorenz_pop <- c(0.0005,
                0.0032,
                0.014799999999999999,
                0.0443,
                0.0991,
                0.257,
                0.4385,
                0.5938,
                0.7089,
                1)

lorenz_welfare <- c(5.824760527229386e-05,
                    0.000604029410841011,
                    0.0037949334793616948,
                    0.013988878652244477,
                    0.036992164583098786,
                    0.12140708906131342,
                    0.24531391873082081,
                    0.37446670169288321,
                    0.48753116241194566,
                    1)


test_that("create_functional_form_lq works as expected", {

  lp <- lorenz_pop[-10]
  lw <- lorenz_welfare[-10]

  y <- c(5.8244212488773904e-05,
         0.00060366455931185,
         0.0037805319592489148,
         0.013793189926297255,
         0.035623744342555719,
         0.10666740778697173,
         0.18513500000774905,
         0.23424139101613642,
         0.24984452808920274)

  x1 <- c(-5.7997605272293861e-05,
          -0.000593789410841011,
          -0.003575893479361695,
          -0.012026388652244476,
          -0.027171354583098786,
          -0.055358089061313426,
          -0.053031668730820825,
          -0.021868261692883195,
          0.015008047588054352)

  x2 <- c(-5.8218481469657719e-05,
          -0.00060209651672631982,
          -0.0037387684638671417,
          -0.013369171327950046,
          -0.033326241072913695,
          -0.09020546717255587,
          -0.13774376536735589,
          -0.15210837422764917,
          -0.14192032137811739)
  x3 <- c(0.00044175239472770615,
          0.0025959705891589894,
          0.011005066520638304,
          0.030311121347755522,
          0.062107835416901208,
          0.13559291093868658,
          0.19318608126917919,
          0.21933329830711679,
          0.22136883758805431)

  out <- create_functional_form_lq(lorenz_pop = lorenz_pop,
                                   lorenz_welfare = lorenz_welfare)

  expect_true(is.data.frame(out))
  expect_equal(dim(out), c(9, 4))
  expect_equal(out$y, y)
  expect_equal(out$x1, x1)
  expect_equal(out$x2, x2)
  expect_equal(out$x3, x3)
})
